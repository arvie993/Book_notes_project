<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Book Notes</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸ“š My Book Notes</h1>
      <p class="subtitle">Books I've read, with notes and ratings</p>
    </header>

    <div class="controls">
      <a href="/add" class="btn btn-primary">+ Add New Book</a>
      
      <div class="sort-controls">
        <label>Sort by:</label>
        <a href="/?sort=recency" class="btn-sort <%= currentSort === 'recency' ? 'active' : '' %>">Recency</a>
        <a href="/?sort=rating" class="btn-sort <%= currentSort === 'rating' ? 'active' : '' %>">Rating</a>
        <a href="/?sort=title" class="btn-sort <%= currentSort === 'title' ? 'active' : '' %>">Title</a>
      </div>
    </div>

    <% if (books.length === 0) { %>
      <div class="empty-state">
        <p>No books yet. Start adding your reading list!</p>
      </div>
    <% } else { %>
      <div class="books-grid">
        <% books.forEach(book => { %>
          <div class="book-card">
            <div class="book-cover">
              <% if (book.cover_url && book.isbn) { %>
                <img src="<%= book.cover_url %>" alt="<%= book.title %> cover" onerror="this.src='/css/placeholder-book.png'; this.onerror=null;">
              <% } else { %>
                <div class="cover-placeholder">
                  <span>ðŸ“–</span>
                </div>
              <% } %>
            </div>
            
            <div class="book-info">
              <h3 class="book-title"><%= book.title %></h3>
              <p class="book-author">by <%= book.author %></p>
              
              <% if (book.rating) { %>
                <div class="rating">
                  <span class="stars">
                    <% for (let i = 0; i < 10; i++) { %>
                      <span class="<%= i < book.rating ? 'filled' : '' %>">â˜…</span>
                    <% } %>
                  </span>
                  <span class="rating-number"><%= book.rating %>/10</span>
                </div>
              <% } %>
              
              <% if (book.date_read) { %>
                <p class="date-read">
                  Read on: <%= new Date(book.date_read).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %>
                </p>
              <% } %>
              
              <% if (book.notes) { %>
                <p class="notes-preview"><%= book.notes.substring(0, 150) %><%= book.notes.length > 150 ? '...' : '' %></p>
              <% } %>
              
              <div class="book-actions">
                <a href="/book/<%= book.id %>" class="btn btn-view">View Details</a>
                <a href="/edit/<%= book.id %>" class="btn btn-edit">Edit</a>
                <form action="/delete/<%= book.id %>" method="POST" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this book?');">
                  <button type="submit" class="btn btn-delete">Delete</button>
                </form>
              </div>
            </div>
          </div>
        <% }); %>
      </div>
    <% } %>
  </div>
</body>
</html>
